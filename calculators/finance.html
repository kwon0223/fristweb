<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸ˆìœµ ê³„ì‚°ê¸°</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <a href="../index.html" class="home-button">ğŸ  í™ˆìœ¼ë¡œ</a>
    <h1>ê¸ˆìœµ ê³„ì‚°ê¸°</h1>

    <!-- í™˜ìœ¨ ê³„ì‚°ê¸° -->
    <div class="calculator">
        <h2>í™˜ìœ¨ ë³€í™˜ê¸°</h2>
        <label for="amount">ê¸ˆì•¡:</label>
        <input type="number" id="amount" placeholder="ê¸ˆì•¡ ì…ë ¥">

        <label for="fromCurrency">ì¶œë°œ í†µí™”:</label>
        <select id="fromCurrency"></select>

        <label for="toCurrency">ë³€í™˜ í†µí™”:</label>
        <select id="toCurrency"></select>

        <button onclick="convertCurrency()">ë³€í™˜</button>
        <p id="exchangeResult"></p>
    </div>

    <!-- ë¶€ê°€ê°€ì¹˜ì„¸ ê³„ì‚°ê¸° -->
    <div class="vat-calculator">
        <h2>ë¶€ê°€ê°€ì¹˜ì„¸ ê³„ì‚°ê¸°</h2>
        <label for="vatAmount">ê¸ˆì•¡ (ì›):</label>
        <input type="number" id="vatAmount" placeholder="ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”" required>

        <label for="vatRate">ë¶€ê°€ê°€ì¹˜ì„¸ ë¹„ìœ¨ (%):</label>
        <input type="number" id="vatRate" placeholder="ì„¸ìœ¨ì„ ì…ë ¥í•˜ì„¸ìš”" required>

        <button onclick="calculateVAT()">ê³„ì‚°í•˜ê¸°</button>

        <div class="result" id="vatResult"></div>
    </div>

    <script>
        // í™˜ìœ¨ ê³„ì‚°ê¸° ì½”ë“œ
        const API_KEY = "89b16ac2c6fe05a6718bed24"; // ğŸ”¥ ë„ˆì˜ API í‚¤ë¥¼ ì—¬ê¸°ì— ì…ë ¥
        const API_URL = `https://v6.exchangerate-api.com/v6/${API_KEY}/latest/USD`;

        let currencyRates = {};

        async function fetchExchangeRates() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                currencyRates = data.conversion_rates;
                populateCurrencyOptions();
            } catch (error) {
                console.error("í™˜ìœ¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", error);
            }
        }

        function populateCurrencyOptions() {
            const fromCurrency = document.getElementById("fromCurrency");
            const toCurrency = document.getElementById("toCurrency");

            Object.keys(currencyRates).forEach(currency => {
                let option1 = new Option(currency, currency);
                let option2 = new Option(currency, currency);
                fromCurrency.add(option1);
                toCurrency.add(option2);
            });

            fromCurrency.value = "USD"; // ê¸°ë³¸ê°’ ì„¤ì •
            toCurrency.value = "KRW";   // ê¸°ë³¸ê°’ ì„¤ì •
        }

        function convertCurrency() {
            let amount = parseFloat(document.getElementById("amount").value);
            let fromCurrency = document.getElementById("fromCurrency").value;
            let toCurrency = document.getElementById("toCurrency").value;
            let resultDisplay = document.getElementById("exchangeResult");

            if (isNaN(amount) || amount <= 0) {
                resultDisplay.innerText = "ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.";
                return;
            }

            if (!currencyRates[fromCurrency] || !currencyRates[toCurrency]) {
                resultDisplay.innerText = "í™˜ìœ¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                return;
            }

            let exchangeRate = currencyRates[toCurrency] / currencyRates[fromCurrency];
            let convertedAmount = (amount * exchangeRate).toFixed(2);

            // ìˆ«ìì— ì‰¼í‘œ ì¶”ê°€
            let formattedAmount = amount.toLocaleString();
            let formattedConvertedAmount = Number(convertedAmount).toLocaleString();

            resultDisplay.innerText = `${formattedAmount} ${fromCurrency} â†’ ${formattedConvertedAmount} ${toCurrency}`;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ í™˜ìœ¨ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        fetchExchangeRates();

        // ë¶€ê°€ê°€ì¹˜ì„¸ ê³„ì‚°ê¸° ì½”ë“œ
        function calculateVAT() {
            const amount = parseFloat(document.getElementById('vatAmount').value);
            const vatRate = parseFloat(document.getElementById('vatRate').value);
            const resultDisplay = document.getElementById('vatResult');

            if (isNaN(amount) || isNaN(vatRate)) {
                resultDisplay.innerText = "ê¸ˆì•¡ê³¼ ë¶€ê°€ê°€ì¹˜ì„¸ ë¹„ìœ¨ì„ ì •í™•í•˜ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                return;
            }

            // ì„¸ê¸ˆ ì œì™¸ ê°€ê²©
            const excludedPrice = amount / (1 + vatRate / 100);
            // ì„¸ê¸ˆ í¬í•¨ ê°€ê²©
            const includedPrice = amount * (1 + vatRate / 100);

            resultDisplay.innerHTML = `
                <p>ë¶€ê°€ê°€ì¹˜ì„¸ ì œì™¸ ê°€ê²©: ${excludedPrice.toFixed(2)} ì›</p>
                <p>ë¶€ê°€ê°€ì¹˜ì„¸ í¬í•¨ ê°€ê²©: ${includedPrice.toFixed(2)} ì›</p>
            `;
        }
    </script>
</body>
</html>
